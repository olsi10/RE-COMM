<!-- detail.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/detail.css">
  <title>Book Detail</title>
</head>
<body>
  <div id="book-detail">

  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const bookId = urlParams.get('id');
    console.log(bookId);

    let api_url = "https://book.interpark.com/api/search.api?key=5DC0043F3B12F1DEA20EE1F13E31A6BF9EDA50043079B11214F1261975344B9E&query=" + bookId + "&output=json";
    console.log(api_url);

    fetch(api_url)
  .then((response) => {
    if (response.ok) {
      return response.json();
    } else {
      throw new Error("API 요청에 실패했습니다.");
    }
  })
  .then((data) => {
    const book = data.item[0];
    console.log(book);

    if (book) {
      // 날짜 포맷팅
      let pub = book.pubDate;
      let pubYear = pub.substr(0, 4);
      let pubMonth = pub.substr(5, 6);
      let pubDay = pub.substr(7, 8);

      // 배경 이미지 변경
      document.body.style.backgroundImage = `url(${book.coverLargeUrl})`;

      const bookDetailDiv = document.getElementById('book-detail');
      bookDetailDiv.innerHTML =`
        <div class="book-profile">
            <img src="${book.coverLargeUrl}" alt="">
            <div class="profile">
                <div class="title">${book.title}</div>
                <div class="info1"> 
                    <div class="author">${book.author}</div>
                    <div class="pub">${book.publisher}</div>
                    <div class="pubyear">${pubYear}년 ${pubMonth}월 ${pubDay}일</div>
                </div>
                <div class="info2">
                    <div class="star">
                        <div class="star-title">읽을만 했어요!</div>
                        <div class="star-img">
                            <img src="../img/books-star-1.png" alt="">
                            <img src="../img/books-star-1.png" alt="">
                            <img src="../img/books-star-1.png" alt="">
                            <img src="../img/books-star-2.png" alt="">
                            <img src="../img/books-star-2.png" alt="">
                        </div>
                    </div>
                    <div class="tag">
                        <div class="grid-tag">
                            <div class="tag-item">1</div>
                            <div class="tag-item">2</div>
                            <div class="tag-item">3</div>
                            <div class="tag-item">4</div>
                            <div class="tag-item">5</div>
                            <div class="tag-item">6</div>
                            <div class="tag-item">7</div>
                            <div class="tag-item">8</div>
                        </div>
                    </div>
                </div>
                <div class="summary">
                    <div class="summary-title">이 책의 줄거리</div>
                    <div class="summary-content">어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕어쩌구저쩌구왕왕</div>
                </div>
            </div>
        </div>
      `;

      let bookDetailHtml = `<h2>${book.title}</h2>`;
      bookDetailHtml += `<p>저자: ${book.author}</p>`;
      bookDetailHtml += `<p>출판사: ${book.publisher}</p>`;
      bookDetailHtml += `<img src="${book.coverLargeUrl}" />`;
    } else {
      console.log('책 정보가 없습니다.');
    }
  })
  .catch((error) => {
    console.log(error);
  });

  // 배경 이미지


  </script>
</body>
</html>
